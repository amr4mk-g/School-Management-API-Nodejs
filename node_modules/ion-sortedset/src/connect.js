
const Redis = require("ioredis");
const debug = require("debug")("Ion-SortedSet:Connect");

const runTest = async (redisClient) => {
	const response = await redisClient.ping();
	if (response === 'PONG') debug('Connection successful.');
	else debug('Connection failed.');
};

const createClient = ({ url }) => {
	debug(`Trying to Create a redis connection to ${url}`);
	const redisClient = new Redis(url);
	runTest(redisClient);
	redisClient.on('error', (error) => { console.error('Ion-SortedSet:Connect:', error.toString()); });
	redisClient.on('end', () => { debug('Ending Session'); });
	return redisClient;
};

module.exports = { createClient };
